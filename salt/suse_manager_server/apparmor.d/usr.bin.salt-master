# Last Modified: Wed Mar 28 12:01:21 2018
#include <tunables/global>

/usr/bin/salt-master flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/python>

  capability     net_admin,
  capability    dac_override,
  capability    setgid,
  capability chown,



  /bin/bash rix,
  /dev/kmsg r,
  /dev/shm/3G43L3 rw,
  /dev/shm/M20Jnj rw,
  /dev/shm/PGB2jz rw,
  /dev/shm/UnCmgP rw,
  /dev/shm/sem.mp13859-11378396775762541964 w,
  /dev/shm/sem.mp13859-12566450739905177905 w,
  /dev/shm/sem.mp13859-18306537118859489615 w,
  /dev/shm/sem.mp13859-7663439402177147817 w,
  /dev/tty rw,
  /etc/ r,
  /etc/SuSE-release r,
  /etc/group r,
  /etc/hostname r,
  /etc/hosts r,
  /etc/iproute2/group r,
  /etc/machine-id r,
  /etc/nsswitch.conf r,
  /etc/os-release r,
  /etc/passwd r,
  /etc/protocols r,
  /etc/resolv.conf r,
  /etc/salt/grains r,
  /etc/salt/master r,
  /etc/salt/master.d/ r,
  /etc/salt/master.d/saltboot.conf r,
  /etc/salt/master.d/susemanager.conf r,
  /etc/salt/pki/master/ r,
  /etc/salt/pki/master/master.pem r,
  /etc/salt/pki/master/minions/ r,
  /etc/salt/pki/master/minions_autosign/ r,
  /etc/salt/pki/master/minions_denied/ r,
  /etc/salt/pki/master/minions_pre/ r,
  /etc/salt/pki/master/minions_rejected/ r,
  /etc/salt/pki/master/ssh/ r,
  /etc/shells r,
  /etc/ssl/openssl.cnf r,
  /proc/*/cgroup r,
  /proc/*/mounts r,
  /proc/*/stat r,
  /proc/*/status r,
  /proc/cmdline r,
  /proc/filesystems r,
  /proc/meminfo r,
  /proc/sys/crypto/fips_enabled r,
  /run/salt-master.pid rw,
  /run/salt/master/ r,
  /run/salt/master/master_event_pub.ipc w,
  /run/salt/master/master_event_pull.ipc w,
  /run/salt/master/publish_pull.ipc w,
  /run/salt/master/workers.ipc w,
  /sbin/ldconfig rix,
  /srv/salt/ r,
  /srv/susemanager/salt/ r,
  /srv/susemanager/salt/custom/ r,
  /srv/susemanager/salt/manager_org_1/ r,
  /srv/susemanager/salt/salt_ssh/ r,
  /sys/block/ r,
  /sys/bus/xen/drivers/ r,
  /sys/devices/pci0000:00/0000:00:05.0/virtio2/block/vda/queue/rotational r,
  /sys/devices/system/cpu/ r,
  /sys/devices/virtual/block/loop0/queue/rotational r,
  /sys/devices/virtual/block/loop1/queue/rotational r,
  /sys/devices/virtual/block/loop2/queue/rotational r,
  /sys/devices/virtual/block/loop3/queue/rotational r,
  /sys/devices/virtual/block/loop4/queue/rotational r,
  /sys/devices/virtual/block/loop5/queue/rotational r,
  /sys/devices/virtual/block/loop6/queue/rotational r,
  /sys/devices/virtual/block/loop7/queue/rotational r,
  /sys/devices/virtual/dmi/id/bios_date r,
  /sys/devices/virtual/dmi/id/bios_version r,
  /sys/devices/virtual/dmi/id/product_name r,
  /sys/devices/virtual/dmi/id/sys_vendor r,
  /usr/bin/dmesg rix,
  /usr/bin/kmod rix,
  /usr/bin/python2.7 ix,
  /usr/bin/salt-master r,
  /usr/bin/systemctl mrcx,
  /usr/bin/systemd-detect-virt mrcx,
  /usr/bin/systemd-notify cx,
  /usr/bin/uname rix,
  /usr/bin/which rix,
  /usr/sbin/getenforce rix,
  /usr/sbin/ip rix,
  /usr/sbin/selinuxenabled rix,
  /usr/share/susemanager/formulas/states/ r,
  /usr/share/susemanager/formulas/states/_states/ r,
  /usr/share/susemanager/formulas/states/bind/ r,
  /usr/share/susemanager/formulas/states/bind/files/ r,
  /usr/share/susemanager/formulas/states/bind/files/arch/ r,
  /usr/share/susemanager/formulas/states/bind/files/debian/ r,
  /usr/share/susemanager/formulas/states/bind/files/freebsd/ r,
  /usr/share/susemanager/formulas/states/bind/files/redhat/ r,
  /usr/share/susemanager/formulas/states/bind/files/suse/ r,
  /usr/share/susemanager/formulas/states/branch-network/ r,
  /usr/share/susemanager/formulas/states/branch-network/files/ r,
  /usr/share/susemanager/formulas/states/dhcpd/ r,
  /usr/share/susemanager/formulas/states/dhcpd/files/ r,
  /usr/share/susemanager/formulas/states/image-sync/ r,
  /usr/share/susemanager/formulas/states/pxe/ r,
  /usr/share/susemanager/formulas/states/pxe/files/ r,
  /usr/share/susemanager/formulas/states/saltboot-orchestrate/ r,
  /usr/share/susemanager/formulas/states/saltboot-reactor/ r,
  /usr/share/susemanager/formulas/states/saltboot/ r,
  /usr/share/susemanager/formulas/states/tftpd/ r,
  /usr/share/susemanager/formulas/states/tftpd/files/ r,
  /usr/share/susemanager/formulas/states/vsftpd/ r,
  /usr/share/susemanager/formulas/states/vsftpd/files/ r,
  /usr/share/susemanager/modules/runners/ r,
  /usr/share/susemanager/modules/runners/mgrk8s.py r,
  /usr/share/susemanager/modules/runners/mgrk8s.pyc w,
  /usr/share/susemanager/modules/runners/mgrutil.py r,
  /usr/share/susemanager/modules/runners/mgrutil.pyc w,
  /usr/share/susemanager/modules/runners/registration.py r,
  /usr/share/susemanager/modules/runners/registration.pyc w,
  /usr/share/susemanager/modules/tops/ r,
  /usr/share/susemanager/salt/ r,
  /usr/share/susemanager/salt/_beacons/ r,
  /usr/share/susemanager/salt/_grains/ r,
  /usr/share/susemanager/salt/_modules/ r,
  /usr/share/susemanager/salt/bootstrap/ r,
  /usr/share/susemanager/salt/certs/ r,
  /usr/share/susemanager/salt/channels/ r,
  /usr/share/susemanager/salt/channels/yum-susemanager-plugin/ r,
  /usr/share/susemanager/salt/cleanup_minion/ r,
  /usr/share/susemanager/salt/cleanup_ssh_minion/ r,
  /usr/share/susemanager/salt/configuration/ r,
  /usr/share/susemanager/salt/custom/ r,
  /usr/share/susemanager/salt/custom_groups/ r,
  /usr/share/susemanager/salt/custom_org/ r,
  /usr/share/susemanager/salt/distupgrade/ r,
  /usr/share/susemanager/salt/hardware/ r,
  /usr/share/susemanager/salt/images/ r,
  /usr/share/susemanager/salt/packages/ r,
  /usr/share/susemanager/salt/remotecommands/ r,
  /usr/share/susemanager/salt/scap/ r,
  /usr/share/susemanager/salt/services/ r,
  /usr/share/susemanager/salt/ssh_bootstrap/ r,
  /usr/share/susemanager/salt/util/ r,
  /var/cache/salt/master/ r,
  /var/cache/salt/master/.root_key rw,
  /var/cache/salt/master/.salt_key rw,
  /var/cache/salt/master/file_lists/ r,
  /var/cache/salt/master/file_lists/roots/ r,
  /var/cache/salt/master/files/ r,
  /var/cache/salt/master/files/base/ r,
  /var/cache/salt/master/files/base/_grains/ r,
  /var/cache/salt/master/files/base/_modules/ r,
  /var/cache/salt/master/files/base/_states/ r,
  /var/cache/salt/master/files/base/bootstrap/ r,
  /var/cache/salt/master/files/base/certs/ r,
  /var/cache/salt/master/files/base/ssh_bootstrap/ r,
  /var/cache/salt/master/jobs/ r,
  /var/cache/salt/master/jobs/00/ r,
  /var/cache/salt/master/jobs/01/ r,
  /var/cache/salt/master/jobs/02/ r,
  /var/cache/salt/master/jobs/04/ r,
  /var/cache/salt/master/jobs/05/ r,
  /var/cache/salt/master/jobs/06/ r,
  /var/cache/salt/master/jobs/07/ r,
  /var/cache/salt/master/jobs/08/ r,
  /var/cache/salt/master/jobs/09/ r,
  /var/cache/salt/master/jobs/0a/ r,
  /var/cache/salt/master/jobs/0b/ r,
  /var/cache/salt/master/jobs/0c/ r,
  /var/cache/salt/master/jobs/0d/ r,
  /var/cache/salt/master/jobs/0f/ r,
  /var/cache/salt/master/jobs/10/ r,
  /var/cache/salt/master/jobs/11/ r,
  /var/cache/salt/master/jobs/12/ r,
  /var/cache/salt/master/jobs/13/ r,
  /var/cache/salt/master/jobs/14/ r,
  /var/cache/salt/master/jobs/15/ r,
  /var/cache/salt/master/jobs/16/ r,
  /var/cache/salt/master/jobs/17/ r,
  /var/cache/salt/master/jobs/18/ r,
  /var/cache/salt/master/jobs/19/ r,
  /var/cache/salt/master/jobs/1a/ r,
  /var/cache/salt/master/jobs/1b/ r,
  /var/cache/salt/master/jobs/1c/ r,
  /var/cache/salt/master/jobs/1d/ r,
  /var/cache/salt/master/jobs/1e/ r,
  /var/cache/salt/master/jobs/1f/ r,
  /var/cache/salt/master/jobs/20/ r,
  /var/cache/salt/master/jobs/21/ r,
  /var/cache/salt/master/jobs/22/ r,
  /var/cache/salt/master/jobs/23/ r,
  /var/cache/salt/master/jobs/24/ r,
  /var/cache/salt/master/jobs/25/ r,
  /var/cache/salt/master/jobs/26/ r,
  /var/cache/salt/master/jobs/27/ r,
  /var/cache/salt/master/jobs/28/ r,
  /var/cache/salt/master/jobs/29/ r,
  /var/cache/salt/master/jobs/2a/ r,
  /var/cache/salt/master/jobs/2b/ r,
  /var/cache/salt/master/jobs/2c/ r,
  /var/cache/salt/master/jobs/2d/ r,
  /var/cache/salt/master/jobs/2e/ r,
  /var/cache/salt/master/jobs/2f/ r,
  /var/cache/salt/master/jobs/30/ r,
  /var/cache/salt/master/jobs/31/ r,
  /var/cache/salt/master/jobs/32/ r,
  /var/cache/salt/master/jobs/33/ r,
  /var/cache/salt/master/jobs/35/ r,
  /var/cache/salt/master/jobs/36/ r,
  /var/cache/salt/master/jobs/37/ r,
  /var/cache/salt/master/jobs/38/ r,
  /var/cache/salt/master/jobs/39/ r,
  /var/cache/salt/master/jobs/3a/ r,
  /var/cache/salt/master/jobs/3b/ r,
  /var/cache/salt/master/jobs/3c/ r,
  /var/cache/salt/master/jobs/3d/ r,
  /var/cache/salt/master/jobs/3e/ r,
  /var/cache/salt/master/jobs/3f/ r,
  /var/cache/salt/master/jobs/40/ r,
  /var/cache/salt/master/jobs/41/ r,
  /var/cache/salt/master/jobs/42/ r,
  /var/cache/salt/master/jobs/43/ r,
  /var/cache/salt/master/jobs/44/ r,
  /var/cache/salt/master/jobs/46/ r,
  /var/cache/salt/master/jobs/47/ r,
  /var/cache/salt/master/jobs/49/ r,
  /var/cache/salt/master/jobs/4a/ r,
  /var/cache/salt/master/jobs/4b/ r,
  /var/cache/salt/master/jobs/4d/ r,
  /var/cache/salt/master/jobs/4e/ r,
  /var/cache/salt/master/jobs/4f/ r,
  /var/cache/salt/master/jobs/50/ r,
  /var/cache/salt/master/jobs/51/ r,
  /var/cache/salt/master/jobs/53/ r,
  /var/cache/salt/master/jobs/54/ r,
  /var/cache/salt/master/jobs/55/ r,
  /var/cache/salt/master/jobs/56/ r,
  /var/cache/salt/master/jobs/57/ r,
  /var/cache/salt/master/jobs/58/ r,
  /var/cache/salt/master/jobs/59/ r,
  /var/cache/salt/master/jobs/5a/ r,
  /var/cache/salt/master/jobs/5b/ r,
  /var/cache/salt/master/jobs/5c/ r,
  /var/cache/salt/master/jobs/5d/ r,
  /var/cache/salt/master/jobs/5e/ r,
  /var/cache/salt/master/jobs/5f/ r,
  /var/cache/salt/master/jobs/60/ r,
  /var/cache/salt/master/jobs/62/ r,
  /var/cache/salt/master/jobs/63/ r,
  /var/cache/salt/master/jobs/64/ r,
  /var/cache/salt/master/jobs/65/ r,
  /var/cache/salt/master/jobs/66/ r,
  /var/cache/salt/master/jobs/67/ r,
  /var/cache/salt/master/jobs/68/ r,
  /var/cache/salt/master/jobs/6a/ r,
  /var/cache/salt/master/jobs/6b/ r,
  /var/cache/salt/master/jobs/6c/ r,
  /var/cache/salt/master/jobs/6d/ r,
  /var/cache/salt/master/jobs/6e/ r,
  /var/cache/salt/master/jobs/6f/ r,
  /var/cache/salt/master/jobs/70/ r,
  /var/cache/salt/master/jobs/71/ r,
  /var/cache/salt/master/jobs/72/ r,
  /var/cache/salt/master/jobs/73/ r,
  /var/cache/salt/master/jobs/74/ r,
  /var/cache/salt/master/jobs/76/ r,
  /var/cache/salt/master/jobs/77/ r,
  /var/cache/salt/master/jobs/78/ r,
  /var/cache/salt/master/jobs/79/ r,
  /var/cache/salt/master/jobs/7a/ r,
  /var/cache/salt/master/jobs/7b/ r,
  /var/cache/salt/master/jobs/7c/ r,
  /var/cache/salt/master/jobs/7d/ r,
  /var/cache/salt/master/jobs/7e/ r,
  /var/cache/salt/master/jobs/7f/ r,
  /var/cache/salt/master/jobs/80/ r,
  /var/cache/salt/master/jobs/81/ r,
  /var/cache/salt/master/jobs/82/ r,
  /var/cache/salt/master/jobs/83/ r,
  /var/cache/salt/master/jobs/84/ r,
  /var/cache/salt/master/jobs/85/ r,
  /var/cache/salt/master/jobs/86/ r,
  /var/cache/salt/master/jobs/87/ r,
  /var/cache/salt/master/jobs/88/ r,
  /var/cache/salt/master/jobs/89/ r,
  /var/cache/salt/master/jobs/8a/ r,
  /var/cache/salt/master/jobs/8c/ r,
  /var/cache/salt/master/jobs/8d/ r,
  /var/cache/salt/master/jobs/8e/ r,
  /var/cache/salt/master/jobs/8f/ r,
  /var/cache/salt/master/jobs/91/ r,
  /var/cache/salt/master/jobs/92/ r,
  /var/cache/salt/master/jobs/93/ r,
  /var/cache/salt/master/jobs/94/ r,
  /var/cache/salt/master/jobs/95/ r,
  /var/cache/salt/master/jobs/96/ r,
  /var/cache/salt/master/jobs/97/ r,
  /var/cache/salt/master/jobs/98/ r,
  /var/cache/salt/master/jobs/99/ r,
  /var/cache/salt/master/jobs/9a/ r,
  /var/cache/salt/master/jobs/9c/ r,
  /var/cache/salt/master/jobs/9d/ r,
  /var/cache/salt/master/jobs/9e/ r,
  /var/cache/salt/master/jobs/9f/ r,
  /var/cache/salt/master/jobs/a0/ r,
  /var/cache/salt/master/jobs/a1/ r,
  /var/cache/salt/master/jobs/a2/ r,
  /var/cache/salt/master/jobs/a3/ r,
  /var/cache/salt/master/jobs/a4/ r,
  /var/cache/salt/master/jobs/a5/ r,
  /var/cache/salt/master/jobs/a6/ r,
  /var/cache/salt/master/jobs/a7/ r,
  /var/cache/salt/master/jobs/a9/ r,
  /var/cache/salt/master/jobs/aa/ r,
  /var/cache/salt/master/jobs/ab/ r,
  /var/cache/salt/master/jobs/ac/ r,
  /var/cache/salt/master/jobs/ad/ r,
  /var/cache/salt/master/jobs/ae/ r,
  /var/cache/salt/master/jobs/af/ r,
  /var/cache/salt/master/jobs/b0/ r,
  /var/cache/salt/master/jobs/b1/ r,
  /var/cache/salt/master/jobs/b2/ r,
  /var/cache/salt/master/jobs/b3/ r,
  /var/cache/salt/master/jobs/b4/ r,
  /var/cache/salt/master/jobs/b5/ r,
  /var/cache/salt/master/jobs/b6/ r,
  /var/cache/salt/master/jobs/b8/ r,
  /var/cache/salt/master/jobs/b9/ r,
  /var/cache/salt/master/jobs/ba/ r,
  /var/cache/salt/master/jobs/bb/ r,
  /var/cache/salt/master/jobs/bc/ r,
  /var/cache/salt/master/jobs/bd/ r,
  /var/cache/salt/master/jobs/be/ r,
  /var/cache/salt/master/jobs/bf/ r,
  /var/cache/salt/master/jobs/c1/ r,
  /var/cache/salt/master/jobs/c2/ r,
  /var/cache/salt/master/jobs/c3/ r,
  /var/cache/salt/master/jobs/c4/ r,
  /var/cache/salt/master/jobs/c5/ r,
  /var/cache/salt/master/jobs/c6/ r,
  /var/cache/salt/master/jobs/c7/ r,
  /var/cache/salt/master/jobs/c8/ r,
  /var/cache/salt/master/jobs/c9/ r,
  /var/cache/salt/master/jobs/ca/ r,
  /var/cache/salt/master/jobs/cb/ r,
  /var/cache/salt/master/jobs/cc/ r,
  /var/cache/salt/master/jobs/cd/ r,
  /var/cache/salt/master/jobs/ce/ r,
  /var/cache/salt/master/jobs/d0/ r,
  /var/cache/salt/master/jobs/d1/ r,
  /var/cache/salt/master/jobs/d2/ r,
  /var/cache/salt/master/jobs/d3/ r,
  /var/cache/salt/master/jobs/d4/ r,
  /var/cache/salt/master/jobs/d5/ r,
  /var/cache/salt/master/jobs/d6/ r,
  /var/cache/salt/master/jobs/d7/ r,
  /var/cache/salt/master/jobs/d8/ r,
  /var/cache/salt/master/jobs/d9/ r,
  /var/cache/salt/master/jobs/da/ r,
  /var/cache/salt/master/jobs/db/ r,
  /var/cache/salt/master/jobs/dc/ r,
  /var/cache/salt/master/jobs/dd/ r,
  /var/cache/salt/master/jobs/de/ r,
  /var/cache/salt/master/jobs/df/ r,
  /var/cache/salt/master/jobs/e0/ r,
  /var/cache/salt/master/jobs/e1/ r,
  /var/cache/salt/master/jobs/e2/ r,
  /var/cache/salt/master/jobs/e3/ r,
  /var/cache/salt/master/jobs/e4/ r,
  /var/cache/salt/master/jobs/e5/ r,
  /var/cache/salt/master/jobs/e7/ r,
  /var/cache/salt/master/jobs/e8/ r,
  /var/cache/salt/master/jobs/e9/ r,
  /var/cache/salt/master/jobs/ea/ r,
  /var/cache/salt/master/jobs/eb/ r,
  /var/cache/salt/master/jobs/ec/ r,
  /var/cache/salt/master/jobs/ed/ r,
  /var/cache/salt/master/jobs/ee/ r,
  /var/cache/salt/master/jobs/ef/ r,
  /var/cache/salt/master/jobs/f0/ r,
  /var/cache/salt/master/jobs/f1/ r,
  /var/cache/salt/master/jobs/f2/ r,
  /var/cache/salt/master/jobs/f3/ r,
  /var/cache/salt/master/jobs/f4/ r,
  /var/cache/salt/master/jobs/f5/ r,
  /var/cache/salt/master/jobs/f6/ r,
  /var/cache/salt/master/jobs/f7/ r,
  /var/cache/salt/master/jobs/f8/ r,
  /var/cache/salt/master/jobs/f9/ r,
  /var/cache/salt/master/jobs/fa/ r,
  /var/cache/salt/master/jobs/fc/ r,
  /var/cache/salt/master/jobs/fe/ r,
  /var/cache/salt/master/minions/ r,
  /var/cache/salt/master/proc/ r,
  /var/cache/salt/master/queues/ r,
  /var/cache/salt/master/roots/ r,
  /var/cache/salt/master/roots/hash/ r,
  /var/cache/salt/master/roots/hash/base/ r,
  /var/cache/salt/master/roots/hash/base/_grains/ r,
  /var/cache/salt/master/roots/hash/base/_modules/ r,
  /var/cache/salt/master/roots/hash/base/_states/ r,
  /var/cache/salt/master/roots/hash/base/certs/ r,
  /var/cache/salt/master/roots/mtime_map rw,
  /var/cache/salt/master/syndics/ r,
  /var/cache/salt/master/thin/ r,
  /var/cache/salt/master/tokens/ r,
  /var/cache/salt/master/tokens/26643af00544366bd4c9a022e095b819cb7b0475856caf15aae4c3b3bff07756 r,
  /var/cache/salt/master/tokens/3757b7edd5e1552e35c2050b6e04c1d3b4c9e5b9fca895e3555abb9e4e2373aa r,
  /var/cache/salt/master/tokens/9c24d1a8c7d23adfe710381d70039b41a0d52f5cd9615d772565c9e8d7cc21cb r,
  /var/cache/salt/master/tokens/b27efb54b5dac71060f7c01d2bee50fc46f6ba4c98952add77d313881e838db1 r,
  /var/lib/ca-certificates/ca-bundle.pem r,
  /var/log/salt/master w,


  profile /usr/bin/systemctl flags=(complain) {
    #include <abstractions/base>


    /proc/*/stat r,
    /proc/cmdline r,
    /proc/filesystems r,
    /proc/sys/crypto/fips_enabled r,
    /usr/bin/systemctl mr,

  }

  profile /usr/bin/systemd-detect-virt flags=(complain) {
    #include <abstractions/base>


    /proc/*/stat r,
    /proc/cmdline r,
    /usr/bin/systemd-detect-virt mr,

  }

  profile /usr/bin/systemd-notify flags=(complain) {
    #include <abstractions/base>

    capability    sys_ptrace,


    /proc/*/environ r,
    /proc/*/stat r,
    /proc/cmdline r,
    /usr/bin/systemd-notify mr,

  }
}

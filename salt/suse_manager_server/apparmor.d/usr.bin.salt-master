# Last Modified: Wed Mar 28 12:01:21 2018
#include <tunables/global>

/usr/bin/salt-master flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/python>

  capability     net_admin,
  capability    dac_override,
  capability    setgid,
  capability chown,



  /bin/bash rix,
  /dev/kmsg r,
  /dev/shm/* rw,
  /dev/tty rw,
  /etc/ r,
  /etc/SuSE-release r,
  /etc/group r,
  /etc/hostname r,
  /etc/hosts r,
  /etc/iproute2/group r,
  /etc/machine-id r,
  /etc/nsswitch.conf r,
  /etc/os-release r,
  /etc/passwd r,
  /etc/protocols r,
  /etc/resolv.conf r,
  /etc/salt/grains r,
  /etc/salt/master r,
  /etc/salt/master.d/ r,
  /etc/salt/master.d/saltboot.conf r,
  /etc/salt/master.d/susemanager.conf r,
  /etc/salt/pki/master/ r,
  /etc/salt/pki/master/master.pem r,
  /etc/salt/pki/master/minions/ r,
  /etc/salt/pki/master/minions_autosign/ r,
  /etc/salt/pki/master/minions_denied/ r,
  /etc/salt/pki/master/minions_pre/ r,
  /etc/salt/pki/master/minions_rejected/ r,
  /etc/salt/pki/master/ssh/ r,
  /etc/shells r,
  /etc/ssl/openssl.cnf r,
  /proc/*/cgroup r,
  /proc/*/mounts r,
  /proc/*/stat r,
  /proc/*/status r,
  /proc/cmdline r,
  /proc/filesystems r,
  /proc/meminfo r,
  /proc/sys/crypto/fips_enabled r,
  /run/salt-master.pid rw,
  /run/salt/master/ r,
  /run/salt/master/master_event_pub.ipc w,
  /run/salt/master/master_event_pull.ipc w,
  /run/salt/master/publish_pull.ipc w,
  /run/salt/master/workers.ipc w,
  /sbin/ldconfig rix,
  /srv/salt/ r,
  /srv/susemanager/salt/ r,
  /srv/susemanager/salt/custom/ r,
  /srv/susemanager/salt/manager_org_1/ r,
  /srv/susemanager/salt/salt_ssh/ r,
  /sys/block/ r,
  /sys/bus/xen/drivers/ r,
  /sys/devices/pci0000:00/0000:00:05.0/virtio2/block/vda/queue/rotational r,
  /sys/devices/system/cpu/ r,
  /sys/devices/virtual/block/loop0/queue/rotational r,
  /sys/devices/virtual/block/loop1/queue/rotational r,
  /sys/devices/virtual/block/loop2/queue/rotational r,
  /sys/devices/virtual/block/loop3/queue/rotational r,
  /sys/devices/virtual/block/loop4/queue/rotational r,
  /sys/devices/virtual/block/loop5/queue/rotational r,
  /sys/devices/virtual/block/loop6/queue/rotational r,
  /sys/devices/virtual/block/loop7/queue/rotational r,
  /sys/devices/virtual/dmi/id/bios_date r,
  /sys/devices/virtual/dmi/id/bios_version r,
  /sys/devices/virtual/dmi/id/product_name r,
  /sys/devices/virtual/dmi/id/sys_vendor r,
  /usr/bin/dmesg rix,
  /usr/bin/kmod rix,
  /usr/bin/python2.7 ix,
  /usr/bin/salt-master r,
  /usr/bin/systemctl mrcx,
  /usr/bin/systemd-detect-virt mrcx,
  /usr/bin/systemd-notify cx,
  /usr/bin/uname rix,
  /usr/bin/which rix,
  /usr/sbin/getenforce rix,
  /usr/sbin/ip rix,
  /usr/sbin/selinuxenabled rix,
  /usr/share/susemanager/formulas/states/ r,
  /usr/share/susemanager/formulas/states/_states/ r,
  /usr/share/susemanager/formulas/states/bind/ r,
  /usr/share/susemanager/formulas/states/bind/files/ r,
  /usr/share/susemanager/formulas/states/bind/files/arch/ r,
  /usr/share/susemanager/formulas/states/bind/files/debian/ r,
  /usr/share/susemanager/formulas/states/bind/files/freebsd/ r,
  /usr/share/susemanager/formulas/states/bind/files/redhat/ r,
  /usr/share/susemanager/formulas/states/bind/files/suse/ r,
  /usr/share/susemanager/formulas/states/branch-network/ r,
  /usr/share/susemanager/formulas/states/branch-network/files/ r,
  /usr/share/susemanager/formulas/states/dhcpd/ r,
  /usr/share/susemanager/formulas/states/dhcpd/files/ r,
  /usr/share/susemanager/formulas/states/image-sync/ r,
  /usr/share/susemanager/formulas/states/pxe/ r,
  /usr/share/susemanager/formulas/states/pxe/files/ r,
  /usr/share/susemanager/formulas/states/saltboot-orchestrate/ r,
  /usr/share/susemanager/formulas/states/saltboot-reactor/ r,
  /usr/share/susemanager/formulas/states/saltboot/ r,
  /usr/share/susemanager/formulas/states/tftpd/ r,
  /usr/share/susemanager/formulas/states/tftpd/files/ r,
  /usr/share/susemanager/formulas/states/vsftpd/ r,
  /usr/share/susemanager/formulas/states/vsftpd/files/ r,
  /usr/share/susemanager/modules/runners/ r,
  /usr/share/susemanager/modules/runners/mgrk8s.py r,
  /usr/share/susemanager/modules/runners/mgrk8s.pyc w,
  /usr/share/susemanager/modules/runners/mgrutil.py r,
  /usr/share/susemanager/modules/runners/mgrutil.pyc w,
  /usr/share/susemanager/modules/runners/registration.py r,
  /usr/share/susemanager/modules/runners/registration.pyc w,
  /usr/share/susemanager/modules/tops/ r,
  /usr/share/susemanager/salt/ r,
  /usr/share/susemanager/salt/_beacons/ r,
  /usr/share/susemanager/salt/_grains/ r,
  /usr/share/susemanager/salt/_modules/ r,
  /usr/share/susemanager/salt/bootstrap/ r,
  /usr/share/susemanager/salt/certs/ r,
  /usr/share/susemanager/salt/channels/ r,
  /usr/share/susemanager/salt/channels/yum-susemanager-plugin/ r,
  /usr/share/susemanager/salt/cleanup_minion/ r,
  /usr/share/susemanager/salt/cleanup_ssh_minion/ r,
  /usr/share/susemanager/salt/configuration/ r,
  /usr/share/susemanager/salt/custom/ r,
  /usr/share/susemanager/salt/custom_groups/ r,
  /usr/share/susemanager/salt/custom_org/ r,
  /usr/share/susemanager/salt/distupgrade/ r,
  /usr/share/susemanager/salt/hardware/ r,
  /usr/share/susemanager/salt/images/ r,
  /usr/share/susemanager/salt/packages/ r,
  /usr/share/susemanager/salt/remotecommands/ r,
  /usr/share/susemanager/salt/scap/ r,
  /usr/share/susemanager/salt/services/ r,
  /usr/share/susemanager/salt/ssh_bootstrap/ r,
  /usr/share/susemanager/salt/util/ r,
  /var/cache/salt/master/ r,
  /var/cache/salt/master/.root_key rw,
  /var/cache/salt/master/.salt_key rw,
  /var/cache/salt/master/file_lists/ r,
  /var/cache/salt/master/file_lists/roots/ r,
  /var/cache/salt/master/files/ r,
  /var/cache/salt/master/files/base/ r,
  /var/cache/salt/master/files/base/_grains/ r,
  /var/cache/salt/master/files/base/_modules/ r,
  /var/cache/salt/master/files/base/_states/ r,
  /var/cache/salt/master/files/base/bootstrap/ r,
  /var/cache/salt/master/files/base/certs/ r,
  /var/cache/salt/master/files/base/ssh_bootstrap/ r,
  /var/cache/salt/master/jobs/ r,
  /var/cache/salt/master/jobs/*/ r,
  /var/cache/salt/master/minions/ r,
  /var/cache/salt/master/proc/ r,
  /var/cache/salt/master/queues/ r,
  /var/cache/salt/master/roots/ r,
  /var/cache/salt/master/roots/hash/ r,
  /var/cache/salt/master/roots/hash/base/ r,
  /var/cache/salt/master/roots/hash/base/_grains/ r,
  /var/cache/salt/master/roots/hash/base/_modules/ r,
  /var/cache/salt/master/roots/hash/base/_states/ r,
  /var/cache/salt/master/roots/hash/base/certs/ r,
  /var/cache/salt/master/roots/mtime_map rw,
  /var/cache/salt/master/syndics/ r,
  /var/cache/salt/master/thin/ r,
  /var/cache/salt/master/tokens/ r,
  /var/cache/salt/master/tokens/* r,
  /var/lib/ca-certificates/ca-bundle.pem r,
  /var/log/salt/master w,


  profile /usr/bin/systemctl flags=(complain) {
    #include <abstractions/base>


    /proc/*/stat r,
    /proc/cmdline r,
    /proc/filesystems r,
    /proc/sys/crypto/fips_enabled r,
    /usr/bin/systemctl mr,

  }

  profile /usr/bin/systemd-detect-virt flags=(complain) {
    #include <abstractions/base>


    /proc/*/stat r,
    /proc/cmdline r,
    /usr/bin/systemd-detect-virt mr,

  }

  profile /usr/bin/systemd-notify flags=(complain) {
    #include <abstractions/base>

    capability    sys_ptrace,


    /proc/*/environ r,
    /proc/*/stat r,
    /proc/cmdline r,
    /usr/bin/systemd-notify mr,

  }
}

# Last Modified: Wed Mar 28 14:02:39 2018
#include <tunables/global>

/usr/sbin/squid flags=(complain) {
  #include <abstractions/base>


  capability setgid,
  capability setuid,

  network inet dgram,
  network inet6 dgram,
  network inet6 stream,


  /dev/shm/squid-cf__metadata.shm rw,
  /dev/shm/squid-cf__queues.shm rw,
  /dev/shm/squid-cf__readers.shm rw,
  /etc/group r,
  /etc/host.conf r,
  /etc/hosts r,
  /etc/nsswitch.conf r,
  /etc/passwd r,
  /etc/resolv.conf r,
  /etc/services r,
  /etc/squid/errorpage.css r,
  /etc/squid/mime.conf r,
  /etc/squid/squid.conf r,
  /proc/filesystems r,
  /proc/meminfo r,
  /proc/sys/crypto/fips_enabled r,
  /proc/sys/kernel/ngroups_max r,
  /run/squid.pid rw,
  /usr/sbin/squid mrix,
  /usr/share/squid/errors/af/error-details.txt r,
  /usr/share/squid/errors/templates/ERR_ACCESS_DENIED r,
  /usr/share/squid/errors/templates/ERR_CACHE_ACCESS_DENIED r,
  /usr/share/squid/errors/templates/ERR_CACHE_MGR_ACCESS_DENIED r,
  /usr/share/squid/errors/templates/ERR_CANNOT_FORWARD r,
  /usr/share/squid/errors/templates/ERR_CONFLICT_HOST r,
  /usr/share/squid/errors/templates/ERR_CONNECT_FAIL r,
  /usr/share/squid/errors/templates/ERR_DIR_LISTING r,
  /usr/share/squid/errors/templates/ERR_DNS_FAIL r,
  /usr/share/squid/errors/templates/ERR_ESI r,
  /usr/share/squid/errors/templates/ERR_FORWARDING_DENIED r,
  /usr/share/squid/errors/templates/ERR_FTP_DISABLED r,
  /usr/share/squid/errors/templates/ERR_FTP_FAILURE r,
  /usr/share/squid/errors/templates/ERR_FTP_FORBIDDEN r,
  /usr/share/squid/errors/templates/ERR_FTP_NOT_FOUND r,
  /usr/share/squid/errors/templates/ERR_FTP_PUT_CREATED r,
  /usr/share/squid/errors/templates/ERR_FTP_PUT_ERROR r,
  /usr/share/squid/errors/templates/ERR_FTP_PUT_MODIFIED r,
  /usr/share/squid/errors/templates/ERR_FTP_UNAVAILABLE r,
  /usr/share/squid/errors/templates/ERR_GATEWAY_FAILURE r,
  /usr/share/squid/errors/templates/ERR_ICAP_FAILURE r,
  /usr/share/squid/errors/templates/ERR_INVALID_REQ r,
  /usr/share/squid/errors/templates/ERR_INVALID_RESP r,
  /usr/share/squid/errors/templates/ERR_INVALID_URL r,
  /usr/share/squid/errors/templates/ERR_LIFETIME_EXP r,
  /usr/share/squid/errors/templates/ERR_NO_RELAY r,
  /usr/share/squid/errors/templates/ERR_ONLY_IF_CACHED_MISS r,
  /usr/share/squid/errors/templates/ERR_PRECONDITION_FAILED r,
  /usr/share/squid/errors/templates/ERR_READ_ERROR r,
  /usr/share/squid/errors/templates/ERR_READ_TIMEOUT r,
  /usr/share/squid/errors/templates/ERR_SECURE_CONNECT_FAIL r,
  /usr/share/squid/errors/templates/ERR_SHUTTING_DOWN r,
  /usr/share/squid/errors/templates/ERR_SOCKET_FAILURE r,
  /usr/share/squid/errors/templates/ERR_TOO_BIG r,
  /usr/share/squid/errors/templates/ERR_UNSUP_HTTPVERSION r,
  /usr/share/squid/errors/templates/ERR_UNSUP_REQ r,
  /usr/share/squid/errors/templates/ERR_URN_RESOLVE r,
  /usr/share/squid/errors/templates/ERR_WRITE_ERROR r,
  /usr/share/squid/errors/templates/ERR_ZERO_SIZE_OBJECT r,
  /usr/share/squid/icons/SN.png r,
  /usr/share/squid/icons/silk/application.png r,
  /usr/share/squid/icons/silk/arrow_up.png r,
  /usr/share/squid/icons/silk/bomb.png r,
  /usr/share/squid/icons/silk/box.png r,
  /usr/share/squid/icons/silk/bricks.png r,
  /usr/share/squid/icons/silk/bullet_red.png r,
  /usr/share/squid/icons/silk/cd.png r,
  /usr/share/squid/icons/silk/chart_line.png r,
  /usr/share/squid/icons/silk/compress.png r,
  /usr/share/squid/icons/silk/computer_link.png r,
  /usr/share/squid/icons/silk/css.png r,
  /usr/share/squid/icons/silk/cup.png r,
  /usr/share/squid/icons/silk/database.png r,
  /usr/share/squid/icons/silk/database_table.png r,
  /usr/share/squid/icons/silk/drive_disk.png r,
  /usr/share/squid/icons/silk/film.png r,
  /usr/share/squid/icons/silk/film_key.png r,
  /usr/share/squid/icons/silk/folder.png r,
  /usr/share/squid/icons/silk/folder_table.png r,
  /usr/share/squid/icons/silk/image.png r,
  /usr/share/squid/icons/silk/information.png r,
  /usr/share/squid/icons/silk/layers.png r,
  /usr/share/squid/icons/silk/layout.png r,
  /usr/share/squid/icons/silk/link.png r,
  /usr/share/squid/icons/silk/music.png r,
  /usr/share/squid/icons/silk/package.png r,
  /usr/share/squid/icons/silk/package_go.png r,
  /usr/share/squid/icons/silk/page_code.png r,
  /usr/share/squid/icons/silk/page_excel.png r,
  /usr/share/squid/icons/silk/page_green.png r,
  /usr/share/squid/icons/silk/page_white.png r,
  /usr/share/squid/icons/silk/page_white_acrobat.png r,
  /usr/share/squid/icons/silk/page_white_c.png r,
  /usr/share/squid/icons/silk/page_white_cplusplus.png r,
  /usr/share/squid/icons/silk/page_white_flash.png r,
  /usr/share/squid/icons/silk/page_white_magnify.png r,
  /usr/share/squid/icons/silk/page_white_picture.png r,
  /usr/share/squid/icons/silk/page_white_powerpoint.png r,
  /usr/share/squid/icons/silk/page_white_stack.png r,
  /usr/share/squid/icons/silk/page_white_text.png r,
  /usr/share/squid/icons/silk/page_white_word.png r,
  /usr/share/squid/icons/silk/page_white_zip.png r,
  /usr/share/squid/icons/silk/page_world.png r,
  /usr/share/squid/icons/silk/photo.png r,
  /usr/share/squid/icons/silk/picture.png r,
  /usr/share/squid/icons/silk/plugin.png r,
  /usr/share/squid/icons/silk/plugin_add.png r,
  /usr/share/squid/icons/silk/script.png r,
  /usr/share/squid/icons/silk/script_gear.png r,
  /usr/share/squid/icons/silk/script_palette.png r,
  /var/cache/squid/00/70/ r,
  /var/cache/squid/00/71/ r,
  /var/cache/squid/01/70/ r,
  /var/cache/squid/01/71/ r,
  /var/cache/squid/02/70/ r,
  /var/cache/squid/02/71/ r,
  /var/cache/squid/03/70/ r,
  /var/cache/squid/03/71/ r,
  /var/cache/squid/04/6F/ r,
  /var/cache/squid/04/70/ r,
  /var/cache/squid/04/71/ r,
  /var/cache/squid/05/6F/ r,
  /var/cache/squid/05/70/ r,
  /var/cache/squid/06/6F/ r,
  /var/cache/squid/06/70/ r,
  /var/cache/squid/07/6F/ r,
  /var/cache/squid/07/70/ r,
  /var/cache/squid/08/6F/ r,
  /var/cache/squid/08/70/ r,
  /var/cache/squid/09/6F/ r,
  /var/cache/squid/09/70/ r,
  /var/cache/squid/0A/6F/ r,
  /var/cache/squid/0A/70/ r,
  /var/cache/squid/0B/6F/ r,
  /var/cache/squid/0B/70/ r,
  /var/cache/squid/0C/6F/ r,
  /var/cache/squid/0C/70/ r,
  /var/cache/squid/0D/6F/ r,
  /var/cache/squid/0D/70/ r,
  /var/cache/squid/0E/6F/ r,
  /var/cache/squid/0E/70/ r,
  /var/cache/squid/0F/6F/ r,
  /var/cache/squid/0F/70/ r,
  /var/cache/squid/swap.state rw,
  /var/cache/squid/swap.state.new rw,
  /var/lib/ca-certificates/ca-bundle.pem r,
  /var/log/squid/access.log w,
  /var/log/squid/cache.log rw,

}
